\chapter{Dynamic Systems and Control}

\section{Introduction}

(from introduction)

"Considering that any currency mechanism is absent from this model of sup-
ply and demand is seems reasonable to find a way to include currency in our
model. This leads to the question of what methods should be used to analyze
the properties of currency."

"The fundamental insight that we present is that because currency is a digital
system, the way to approach its analysis is roughly analogous to the way we
approach the analysis and design of other digital systems (the internet being an
interesting case in point), i.e. that we should approach the analysis of currency
as an engineering problem, and in particular the engineering and control of
dynamic systems."

In this chapter we introduce foundations for an engineering analysis of currency. Dynamic systems
and control system engineering are a broad, over-arching engineering disciples relevant across
virtually all more specialized disciplines. We require a good understanding of negative feedback,
positive feedback, PID controllers, the effects of noise and errors on systems and design responses
to handle noise and errors.

We do not use an engineering approach for the analysis of the equilibriation process observed in
markets. The only rule the we accept governs market behaviour is the lawx of supply and demand only
at an aggregate level, as was so nicely described by David Hume. The only assumption we make about
the law of supply and demand at an aggregate level is that the price level and quantities and goods
and services adjust to the point where aggregate excess supply or aggregate excess demand tend to
zero. We only accept this assumption to the extent that it can be empirically justified.

\section{Negative Feedback}

We are looking for a way that we can keep the conditions of the system in some desirable state.
Examples are ... If the system is predictable can use an open system. Many systems, however are not
completely predictable. In many case, despite the unpredictability we can still control the system
to a certain degree. One method is to use a closed system. Another method is to introduce a
sophisticated controller into the loop, such as a human, in combination with the mechanism. Examples
are ...

A heater with a fixed output.

A heater with a thermostat.

Using a schema similar to \ref{fig:feedback_schema} we can represent the cyclist as,

\begin{figure}
\includegraphics[scale=0.48]{/02/bicycle_feedback_schema}
\caption{Bicycle Feedback Schema}
\label{fig:bicycle_feedback_schema}
\end{figure}

The 'reference signal' or 'set point' is the goal of the system, in this case most likely a
desination and when they want to arrive. The controller takes the set point and the present
conditions, i.e. where the cyclist is currently, the location of obstacles, if the road is heading
uphill or downhill etc.  weather conditions are, how much time they have remaining and convert this
into a control signal. Part of the control signal in this case is observable - the person's
adjustments to the handle-bars, other signals are not observable such as decisions on how hard to
pedal. The actuator in this case is the cyclists leg muscles, which convert those desicions, and use
energy to convert them into pedal pressure. The cyclist then observes the situation again and reacts
to the situation by feeding their sensory data back into the 'controller' and so on in a closed
loop. In the case of the cyclist we depend on continuous inputs in a changing, often unpredictable
environment to adjust behaviour - we require a closed loop system.

\subsubsection{Huygens}

\subsubsection{Watt}

\subsection{PID controller}

\subsubsection{James Clerk Maxwell}

\subsubsection{The Wright Brothers}

Prior to the Wright brother's first flight in December 1903, Orville and Wilbur Wright believed that
the most fundamental problems they needed to solve were control problems. In September 1901 Wilbur
Wright's first public presentation on the feasibility of heavier-than-air flight stated that ``When
this one feature [control] has been worked out the age of flying machines will have arrived, for all
other difficulties are of minor importance."\cite{wright1908}

% TODO - this paragraph requires work.

The general view prior to the Wright brothers was that aircraft required the mechanism to
self-stabilize. [this was a problem because incorporating stability into the air-craft was at the
cost of agility. Possibly because the Wright brothers were bicycle-shop owners, and were aware that
bicycles are fundamentally unstable and require human intervention to stay upright, they understood
that this control could be done by the pilot rather than the plane.

\subsubsection{Elmer Sperry}

Elmer Sperry was the first to construct a PID controller. One notable characteristic of PID
controllers is that despite much work in the design of more sophisticated controllers, PID
controllers are by far the most widely used, demonstrating robustness to solve a broad range of
control problems.

Elmer Sperry is best known for his construction and application of gyroscopes following the
invention of the first practical gyroscope by Hermann Ansch√ºtz-Kaempfe in 1904. One of Sperry's
applications was the use of a gyroscope as a component in a control system to self-stabilize
airplanes.

[longer flights]
 
Following on from these experiences, he worked with the U.S. Navy to use gyroscopes for stabilizing
ships, and then also to build control systems as auto-pilots of ships. Because the control process
involved in steering large ships with significant lags and so was relative slow and visible, he was
able to observe that skilled helmsmen used a more nuanced 'algorithm' than just a proportional
response, and that the helmsman with put the helm over in the opposite to the directions in which
the ship was yawing a significantly in advance (a D response), and that helmsman worked the ship
upwards in response to currents and prevailing wind (an I response). Sperry then incorporated these
three responses (P, I and D) into his mechanical control mechanism which connected the gyroscope to
the ships steering.

In 1922 Nicolas Minorsky published a paper which encapsulated the P, I and D into an
equation.\cite{minorsky1922}

\section{Positive Feedback}

\section{Error Correction}

\section{Isolation}

\section{Stability}

\section{The Internet}

\subsubsection{Introduction to the Internet}

Internet routing works extra-ordinarily well. Why is this?

The English team.

Baran

- thinking about the network as a dynamic system
- by reducing the granularity of the feedback (packets) rather than connections one can be more
  responsive to changes in network condition.


The two fundamental feedback problems are

\begin{enumerate}
    \item choosing a route
    \item fill up that route
\end{enumerate}


One might expect that the choice of route is determined by feeding back to the routing control
components in the system, information about round-trip times.

Very interestingly, this isn't how choice of route is determined.

In general, route choice is determined statically by the system administrators for each owned
component of network.  

This seems surprising on two points,

\begin{enumerate}
    \item If route choice is so static how can the system respond to change?
    \item Routes remain very dynamic. If we use 'traceroute' on an internet request, the route is
        always changing.
\end{enumerate}

The important point is that computer networks are extremely bursty and unpredictable. It is the
nature of computer network traffic that it occurs in bursts. This introduces large amounts of noise
into the feedback process. 

The way to handle this unpredictability is to increase the time-frame response. By aggregating data
we can smooth out the response. In other words, by making the feedback slower we can increase its
effectiveness.   

The companies that own the network are motivated to optimizing the this feedback process. So
economics comes into the loop.

One draw-back of economic feedback across the network is that system administrators optimize the
network for their own customers.

How does this guarantee that the network is also optimized for temporary non-paying users of that
network?



There are a couple of important economic lessons/analogies here:

1. aggregating    
2. feedback doesn't necessarily have to be built in from the smallest granularity upwards,
   system-administration of internet areas is sufficient.

It may well be (though not guaranteed) that the feedback in aggregated systems (such as the whole
economy) can work well, even if the components are clumpy (as in administrative areas in the
internet). [reword]

It is not a-priory guaranteed that such systems are stable or unstable. Ultimately, the stability of
a system can only be guaranteed through a process of redesign and testing (i.e. a scientific
process).

This is also experienced with the internet - we can see that iterative improvement process at all
levels, and redesign responses to failure.

[history of fixing the problems of the internet]

\subsection{Details of the Internet}


\subsubsection{Packet Switching}

\subsubsection{Baran}
\subsubsection{Davies}

\subsubsection{Routing Algorithms}

Two feedbacks - 

\subsubsection{TCP - Route Filling}

\subsubsection{Packet Loss}

How does TCP protocol respond to packet loss?

\subsubsection{The Problem of Burstiness} 

subsection{Fixing Problems}

\subsubsection{Congestion Collapse}



Nagle \cite{nagle1984}

\begin{quote}
Congestion control is a recognized problem in complex networks. We have discovered that the
Department of Defense's Internet Protocl (IP), a pure datagram protocol, and Transmission Control
Protocol (TCP), a transport later protocol, when used together, are subject to unusual congestion
problems cause by interactions between the transport and datagram layers. In particular, IP gateways
are vulnerable to a phenomenon we call "congestion collapse", especially when such gateways connect
networks of widely different bandwidth...

Should the roundtrip time exceed the maximum retransmission interval for any host that host will
    begin to introduce more and more copies of the same datagrams into the ne t. The network is now
    in serious trouble. Eventually all available buffers in the switching nodes will be full and
    packets must be dropped. The roundtrip time for packets that are delivered is now at its
    maximum. Hosts are sending each packet several time, and eventually some copy of each packet
    arrives at its destination. The is congestion collapse.

The condition is stable.Once the saturation point has been reached, if th4 algorithm for selecting
    packets to be dropped is fair, the network will continue to operate in a degraded condition.
\end{quote}

To prevent this situation flow-control, congestion control, and congestion avoidance mechanisms were
introduced into the TCP protocol.

The 'wrong behaviour' can be described as a positive feedback.


We can't predict everything when we design a system, as the system evolves.

\begin{quote}
Ford Aerospace and Communications Corporation, and its parent company, Ford Motor Company, operate
    the only private IP/TCP long-haul network in existence today. This network connects four
    facilities (one in Michigan, two in California, and on in England) some with extensive local
    networks.... Bandwidth of links in this network varies widely, from 1200 to 10,000,000 bits per
    second. ... Because of our pure datagram orientation, heavy loading, and wide variation in
    bandwith, we have had to solve problems that the ARPANET / MILNET communicty is just beginning
    to recognize.
\end{quote}

\subsubsection{October 1986 Congestion Collapse}

Jacobson \cite{jocobson1988} discusses a principle to prevent congestion collapse

\begin{quote}
    The flow on a TCP connection should obey a 'conservation of packets' principle. ... By
    'conservation of packets' we mean that for a connection 'in equilibrium', i.e., running stably
    with a full window of data in transit, the packet flow is what a physicist would call
    'conservative': A new packet isn't put into the network until an old packet leaves. The physics
    of flow predicts that systems with this property should be robust in the face of congestion.
    Observation of the Internet suggests that it was not paricularly robust. Why the discrepancy?

    There are only three ways for packet conservation to fail:
    1. The connection doesn't get to equilibrium, or
    2. A sender inject a new packet before an old packet has exited, or
    3. The equilibrium can't be reached because of resource limits along the path.
\end{quote}

This isn't the complete picture, because if time-outs come into play, then we get a positive
feedback.




